# AI Email Assistant: Natural Language to Email Automation

## Overview

AI Email Assistant is a FastAPI-based backend application that leverages generative AI models (such as Gemini via the OpenAI API interface) to automate the process of generating and sending professional emails from natural language input. The system integrates with Gmail for sending emails and supports robust credential management and environment configuration.

---

## Project Structure
```
your_project/
├── app/
│   ├── __init__.py
│   ├── main.py                 # FastAPI application entry point
│   ├── core/
│   │   ├── __init__.py
│   │   ├── config.py           # Application settings and environment variables
│   ├── api/
│   │   ├── __init__.py
│   │   ├── v1/
│   │   │   ├── __init__.py
│   │   │   ├── endpoints/
│   │   │      ├── __init__.py
│   │   │      ├── genai.py    # Endpoints for GenAI interactions
│   │   │      └── users.py    # Example: User-related endpoints
│   ├── services/
│   │   ├── __init__.py
│   │   ├── genai_service.py    # Business logic for GenAI interactions (e.g., calling LLMs)
│   │   └── user_service.py     # Example: Business logic for user management
│   ├── models/
│   │   ├── __init__.py
│   │   ├── genai_models.py     # Database models related to GenAI (if applicable)
│   │   └── user_models.py      # Example: Database models for users
│   └── utils/
│       ├── __init__.py
│       └── helpers.py # General utility functions
├── tests/
│   ├── __init__.py
│   ├── api/
│   │   └── test_genai_endpoints.py
│   └── services/
│       └── test_genai_service.py
├── .env                        # Environment variables
├── requirements.txt            # Project dependencies
└── README.md
```

## Detailed File Descriptions

### [app/main.py](app/main.py)

- **Purpose:** Entry point for the FastAPI application.
- **Key Features:**
  - Initializes the FastAPI app with title, description, and version.
  - Adds CORS middleware to allow all origins (for development and testing).
  - Includes the email-related API router under `/api/v1/genai`.
- **Relevant Imports:** [`email`](app/api/v1/endpoints/email.py) router.

---

### [app/api/v1/endpoints/email.py](app/api/v1/endpoints/email.py)

- **Purpose:** Defines API endpoints for health checks and the main email generation/sending workflow.
- **Endpoints:**
  - `GET /health`: Returns a simple health status string.
  - `POST /generate-and-send`: Accepts a [`UserMessage`](app/models/user_message.py) payload, generates an email using GenAI, validates the response, and sends the email via Gmail.
- **Workflow:**
  1. Receives user input (recipient, message, sender name).
  2. Calls [`call_genai_model`](app/services/llm.py) to generate a structured email.
  3. Validates the GenAI output using [`EmailResponse`](app/models/email_response.py).
  4. Obtains Gmail credentials via [`get_credentials`](app/utils/helper.py).
  5. Sends the email using [`send_email`](app/services/gmail_sender.py).
  6. Handles and reports errors at each step.

---

### [app/core/config.py](app/core/config.py)

- **Purpose:** Loads and manages application configuration and environment variables.
- **Key Features:**
  - Uses `dotenv` to load environment variables from `.env`.
  - Defines a `Config` class with:
    - `OPENAI_API_KEY`: For OpenAI API access.
    - `GOOGLE_API_KEY`: For Gemini API access (used as the OpenAI API key for Gemini).

---

### [app/models/user_message.py](app/models/user_message.py)

- **Purpose:** Pydantic model for user input to the email generation endpoint.
- **Fields:**
  - `to_email`: Recipient's email address.
  - `message`: The natural language message to be converted into an email.
  - `sender_name`: Name of the sender to be used in the email signature.

---

### [app/models/email_response.py](app/models/email_response.py)

- **Purpose:** Pydantic model for the structured email generated by GenAI.
- **Fields:**
  - `subject`: The subject line of the generated email.
  - `body`: The body content of the generated email.

---

### [app/services/llm.py](app/services/llm.py)

- **Purpose:** Handles interaction with the generative AI model (Gemini via OpenAI API interface).
- **Key Features:**
  - Loads the Gemini API key from [`Config`](app/core/config.py).
  - Initializes an OpenAI client with Gemini endpoint.
  - Defines `call_genai_model(email_request)`:
    - Sends a prompt to the model to generate a professional email (subject and body) based on user input.
    - Uses [`EmailResponse`](app/models/email_response.py) as the response schema.
    - Returns the generated email as a JSON string.
  - Raises an error if the API key is missing.

---

### [app/services/gmail_sender.py](app/services/gmail_sender.py)

- **Purpose:** Sends emails using the Gmail API.
- **Key Features:**
  - Defines `send_email(subject, body, to_email, creds)`:
    - Builds a Gmail API service using provided credentials.
    - Constructs a MIME email message.
    - Encodes the message in base64.
    - Sends the email via the Gmail API.

---


## Environment Variables

- **.env** file should contain: